# gulp-lb-include

Library for using [`lb-include`](https://github.com/jffry/lb-include) as a [`gulp`](https://github.com/gulpjs/gulp) plugin

Builds hosted by [Travis CI](https://travis-ci.org/jffry/gulp-lb-include):
`master`: [<img src="https://api.travis-ci.org/jffry/gulp-lb-include.svg?branch=master" valign="middle" />](https://travis-ci.org/jffry/gulp-lb-include),
`develop`: [<img src="https://api.travis-ci.org/jffry/gulp-lb-include.svg?branch=develop" valign="middle" />](https://travis-ci.org/jffry/gulp-lb-include)


* [Install](#install)
* [Getting Started](#getting-started)
* [Configuration](#configuration)
* [Root Directory](#root-directory)
* [Tests](#tests)
* [License](#license)


## Install

```sh
$ npm install --save-dev gulp-lb-include
```

## Getting Started

It's easy to use!

```js
var gulp = require('gulp');
var lbInclude = require('gulp-lb-include');

gulp.task('include', function ()
{
    return gulp.src('app/**/*.html')
        .pipe(lbInclude())
        .pipe(gulp.dest('build/'));
});
```

You can also `npm install` and use [`gulp-plumber`](https://github.com/floatdrop/gulp-plumber) to tidily log
any errors that might get emitted, instead of having to trap and log them yourself:

```js
var gulp = require('gulp');
var plumber = require('gulp-plumber');
var lbInclude = require('gulp-lb-include');

gulp.task('include', function ()
{
    return gulp.src('app/**/*.html')
        .pipe(plumber())
        .pipe(lbInclude())
        .pipe(gulp.dest('build/'));
});
```

## Configuration

You can pass an optional configuration object, which will be passed through to `lb-include`.

```js
gulp.task('include-with-opts', function ()
{
    return gulp.src('app/**/*.html')
        .pipe(lbInclude({ varDefaults: {...} }))
        .pipe(gulp.dest('build/'));
});
```

You can pass any option supported by `lb-include` (see the [documentation for `lb-include`](https://github.com/jffry/lb-include)
for the entire list), aside from `fileContents`.  This plugin will set `fileContents` to the file contents provided by `gulp`.

## Root Directory

In the examples above, the [`base`](https://github.com/wearefractal/glob-stream#options) directory
from `gulp.src` will be used to resolve root-relative `#include`s like `<!-- #include file="/templates/nav.html" -->`

By default, the `base` directory in `gulp.src` is everything before the `glob` pattern (see the README for
[`glob2base`](https://github.com/wearefractal/glob2base) for details).

If you wish to use a different directory for resolving root-relative `#include`s, you can do so by passing
the `root` option to `lb-include` 

```js
gulp.task('include-custom-root', function ()
{
    return gulp.src('app/subdir/**/*.html')
        .pipe(lbInclude({ root: 'app/' }))
        .pipe(gulp.dest('build/'));
});
```

## Tests

To run the tests, checkout this repo and then `npm install && npm test`.
To rerun the tests automatically as you edit files, use `npm run test-watch` instead.


## License

Released under the MIT license Â© [Jeffrey Stanton](https://github.com/jffry)

See [LICENSE.md](LICENSE.md) for full license text
